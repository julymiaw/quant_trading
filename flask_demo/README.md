# Flask智能搜索Demo

这个Demo展示了如何实现一个带有智能搜索提示功能的Web界面，用于查询量化交易系统中的策略、参数、指标和数据表。

## 功能特性

- **智能下拉联想**：用户输入时自动提供相关建议
- **多类型节点支持**：支持策略、参数、指标、数据表四种节点类型
- **分阶段搜索**：
  - 数据表：表名 → 字段名
  - 其他类型：用户名 → 实体名
- **实时搜索**：输入内容变化时自动触发搜索
- **键盘导航**：支持上下箭头键和回车键选择

## 项目结构

```
flask_demo/
├── app.py                 # Flask主应用文件
├── database.py            # 数据库连接和查询模块
├── config.json           # 数据库配置文件
├── requirements.txt      # Python依赖包列表
├── templates/
│   └── index.html        # 主页面模板
└── README.md            # 本文档
```

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置数据库

确保 `config.json` 中的数据库密码正确：

```json
{
    "db_password": "your_mysql_password",
    "tushare_token": "your_tushare_token"
}
```

### 3. 确保数据库已初始化

确保MySQL中已创建并初始化了 `quantitative_trading` 数据库。

### 4. 运行应用

```bash
python app.py
```

### 5. 访问应用

打开浏览器访问：http://localhost:5000

## 使用说明

### 搜索规则

1. **数据表类型**：
   - 输入表名：`daily` 或 `daily_basic`
   - 输入点号：`daily.`
   - 继续输入字段名：`daily.close`

2. **策略/参数/指标类型**：
   - 输入用户名：`system`
   - 输入点号：`system.`
   - 继续输入实体名：`system.小市值策略`

### 界面操作

1. 选择节点类型（必须）
2. 在搜索框中输入，系统会自动显示建议
3. 点击建议项或使用键盘导航选择
4. 支持的键盘操作：
   - ↑/↓：导航建议列表
   - Enter：选择当前建议
   - Esc：关闭建议列表

## API接口

### POST /api/suggestions

获取智能搜索建议

**请求格式：**
```json
{
    "node_type": "策略|参数|指标|数据表",
    "input_text": "用户输入的文本"
}
```

**响应格式：**
```json
{
    "success": true,
    "suggestions": ["建议1", "建议2", "建议3"]
}
```

## 技术实现

### 后端 (Flask)

- **app.py**：主应用逻辑和API路由
- **database.py**：数据库连接管理和查询方法
- 支持的查询类型：
  - 表名搜索
  - 字段名搜索  
  - 用户名搜索
  - 策略/参数/指标搜索

### 前端 (HTML + JavaScript)

- **响应式界面**：支持不同屏幕尺寸
- **实时搜索**：300ms延迟防抖
- **键盘导航**：完整的键盘操作支持
- **用户体验优化**：加载状态、错误处理等

## 扩展建议

1. **缓存优化**：添加Redis缓存提高响应速度
2. **分页支持**：对于大量结果实现分页加载
3. **模糊搜索**：支持更复杂的搜索算法
4. **权限控制**：添加用户权限验证
5. **日志记录**：添加操作日志和错误日志

## 注意事项

- 确保MySQL服务正在运行
- 确保数据库中有测试数据
- 网络延迟可能影响搜索响应速度
- 建议在生产环境中使用HTTPS