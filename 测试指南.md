# 策略管理系统测试指南

## 问题排查步骤

### 1. 数据库初始化
首先确保数据库正确初始化：

```bash
python init_db_simple.py
```

这会创建数据库、表结构，并插入测试数据：
- 用户：system (密码: 123456)
- 用户：testuser (密码: 123456)
- 3个测试策略

### 2. 启动后端服务
```bash
python app.py
```

后端会在 http://localhost:5000 启动

### 3. 测试API
```bash
python test_strategy_api.py
```

### 4. 启动前端服务
```bash
cd frontend
npm run dev
```

前端会在 http://localhost:3000 启动

## 常见问题及解决方案

### 问题1: "获取策略列表失败"

**可能原因：**
1. 后端服务未启动
2. 数据库连接失败
3. Token验证失败
4. 数据库表不存在

**排查步骤：**
1. 访问 http://localhost:5000/health 检查后端服务
2. 检查数据库连接配置
3. 确认用户已登录并获得有效token
4. 检查数据库表是否存在

### 问题2: 登录失败

**可能原因：**
1. 用户不存在
2. 密码错误
3. 数据库连接问题

**解决方案：**
1. 运行 init_db_simple.py 创建测试用户
2. 使用正确的用户名密码（system/123456 或 testuser/123456）

### 问题3: CORS跨域错误

**解决方案：**
后端已配置 CORS，如仍有问题，检查：
1. 前端请求URL是否正确 (http://localhost:5000)
2. 请求头是否正确设置

## 测试流程

### 手动测试流程：
1. 访问前端登录页面
2. 使用 system/123456 或 testuser/123456 登录
3. 查看策略列表
4. 测试策略的增删改查功能

### API测试流程：
1. 健康检查: GET /health
2. 用户登录: POST /auth/login
3. 获取策略列表: GET /api/strategies
4. 创建策略: POST /api/strategies
5. 获取策略详情: GET /api/strategies/{creator}/{name}
6. 更新策略: PUT /api/strategies/{creator}/{name}
7. 删除策略: DELETE /api/strategies/{creator}/{name}

## 调试技巧

### 后端调试：
1. 查看终端日志输出
2. 在代码中添加 print 或 logger 语句
3. 使用 Postman 或 curl 直接测试API

### 前端调试：
1. 打开浏览器开发者工具
2. 查看 Console 错误信息
3. 查看 Network 面板的API请求响应
4. 检查 localStorage 中的token和用户信息

### 数据库调试：
```sql
-- 检查用户表
SELECT * FROM User;

-- 检查策略表
SELECT * FROM Strategy;

-- 检查表结构
DESCRIBE Strategy;
```

## 当前实现状态

### ✅ 已完成功能：
- 用户登录注册
- 策略列表查看（支持筛选、分页）
- 策略创建
- 策略详情查看
- 策略编辑（基本信息、代码）
- 策略删除
- 策略复制
- 权限控制（只能编辑自己的策略）

### ⚠️ 部分实现：
- 策略参数管理（API已实现，前端需完善）
- 数据源自动完成

### ❌ 待实现：
- 策略回测功能
- 参数的完整CRUD操作
- 策略执行和信号生成
- 更丰富的筛选和搜索功能

如果仍遇到"获取策略列表失败"的问题，请：
1. 先运行 init_db_simple.py 初始化数据库
2. 再运行 python app.py 启动后端
3. 运行 test_strategy_api.py 验证API
4. 最后启动前端测试

如果问题依然存在，请提供具体的错误信息和日志。