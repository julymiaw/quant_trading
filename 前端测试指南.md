# 量化交易系统前端测试指南

## 前置条件

### 1. 启动后端服务
```bash
python app.py
```
后端服务将在 `http://localhost:5000` 启动

### 2. 启动前端服务
```bash
cd frontend
npm run dev
```
前端服务将在 `http://localhost:5173` 启动

---

## 测试流程

### 第一步：用户注册测试

1. **打开页面**: 访问 `http://localhost:5173`，会自动跳转到登录页面
2. **点击注册按钮**: 在登录页面点击"注册新账户"链接跳转到注册页面
3. **填写注册信息**:
   - **用户名**: `test_user`
   - **密码**: `test_password`
   - **邮箱**: `test@example.com`
   - **手机号**: `13800138000`（可选）
4. **点击注册按钮**
5. **期望结果**: 注册成功，自动跳转到登录页面

### 第二步：用户登录测试

1. **在登录表单中输入以下信息**：
   - **用户名**: `test_user`
   - **密码**: `test_password`
2. **点击登录按钮**
3. **期望结果**: 成功登录并跳转到主页面

---

### 第三步：指标管理测试

#### 3.1 查看指标列表

1. **导航到指标管理**: 在左侧菜单点击"指标管理"
2. **查看列表**: 应该能看到系统指标列表
3. **测试筛选功能**:
   - 创建者筛选：选择"system"
   - 状态筛选：选择"启用"
   - 搜索框输入"MACD"进行搜索
4. **测试分页**: 如果数据较多，测试分页功能

#### 3.2 创建新指标

1. **点击"添加指标"按钮**
2. **在弹窗中填写**:
   - **指标名称**: `TEST_RSI`
   - **计算方法**:

     ```python
     def calculation_method(params):
         close = params["daily.close"]
         return 50.0  # 简化的RSI计算
     ```

   - **指标说明**: `测试RSI指标`
   - **状态**: 启用
3. **点击保存**
4. **期望结果**: 指标创建成功，列表中显示新指标

#### 3.3 编辑指标

1. **找到刚创建的TEST_RSI指标**
2. **点击编辑按钮**
3. **修改指标说明为**: `修改后的RSI指标说明`
4. **修改计算方法**:

   ```python
   def calculation_method(params):
       close = params["daily.close"]
       return 60.0  # 修改后的RSI计算
   ```

5. **点击保存**
6. **期望结果**: 指标更新成功，显示更新提示

#### 3.4 测试指标状态切换

1. **找到TEST_RSI指标**
2. **点击状态开关**（切换启用/禁用）
3. **期望结果**: 状态成功切换，显示成功提示
4. **再次点击状态开关**（重新启用）

#### 3.5 测试指标删除

1. **找到TEST_RSI指标**
2. **点击删除按钮**
3. **在确认对话框点击确定**
4. **期望结果**: 指标删除成功，从列表中消失

---

### 第四步：参数管理测试

#### 4.1 查看参数列表

1. **导航到参数管理**: 在左侧菜单点击"参数管理"
2. **查看列表**: 应该能看到系统参数列表
3. **测试筛选功能**:
   - 参数类型选择"我的参数"
   - 参数来源类型选择"数据表"
   - 搜索框输入"close"进行搜索
4. **测试分页**: 如果数据较多，测试分页功能

#### 4.2 创建新参数

1. **点击"添加参数"按钮**
2. **在弹窗中填写**:
   - **参数名称**: `test_close_5`
   - **参数类型**: 数据表
   - **数据来源ID**: `daily.close`
   - **聚合函数**: `SMA`
   - **向前取历史天数**: `5`
   - **向后预测天数**: `0`
3. **点击保存**
4. **期望结果**: 参数创建成功，列表中显示新参数

#### 4.3 编辑参数

1. **找到刚创建的test_close_5参数**
2. **点击编辑按钮**
3. **修改以下内容**:
   - **向前取历史天数**: 改为`10`
   - **聚合函数**: 改为`EMA`
4. **点击保存**
5. **期望结果**: 参数更新成功，显示更新提示

#### 4.4 测试数据源自动完成

1. **点击"添加参数"按钮**
2. **在数据来源ID字段输入**: `daily.`
3. **期望结果**: 显示自动完成下拉列表（close, high, low, open等）
4. **选择**: `daily.high`
5. **填写其他必需字段**并保存
6. **期望结果**: 参数创建成功

#### 4.5 删除参数

1. **找到刚创建的参数**
2. **点击删除按钮**
3. **在确认对话框点击确定**
4. **期望结果**: 参数删除成功，从列表中消失

---

### 第五步：策略管理测试

#### 5.1 查看策略列表

1. **导航到策略管理**: 在左侧菜单点击"策略管理"
2. **查看列表**: 应该能看到系统策略列表
3. **测试筛选功能**:
   - 创建者筛选：选择"system"
   - 生效范围筛选：选择"全部股票"
   - 搜索框输入"MACD"进行搜索
4. **测试分页**: 如果数据较多，测试分页功能

#### 5.2 创建新策略

1. **点击"添加策略"按钮**
2. **填写基本信息**:
   - **策略名称**: `测试均线策略`
   - **策略描述**: `简单的双均线策略测试`
   - **是否公开**: 勾选
   - **生效范围**: 全部股票
   - **持仓数量**: `10`
   - **调仓间隔**: `5`
   - **买入手续费**: `0.0003`
   - **卖出手续费**: `0.0013`

3. **填写选股函数**:

   ```python
   def select_func(context, data):
       # 简单的选股逻辑
       stocks = context.get_universe()
       
       # 获取收盘价
       close_prices = data.get_current_data(stocks, 'close')
       
       # 选择前10只股票
       selected = list(close_prices.keys())[:10]
       
       # 等权重分配
       weights = {}
       weight_per_stock = 1.0 / len(selected)
       for stock in selected:
           weights[stock] = weight_per_stock
       
       return weights
   ```

4. **填写风控函数**:

   ```python
   def risk_control_func(context, data):
       # 简单的止损逻辑
       current_positions = context.get_positions()
       
       for stock, position in current_positions.items():
           current_price = data.get_current_price(stock)
           cost_price = position.cost_price
           
           # 如果亏损超过10%，则卖出
           if current_price < cost_price * 0.9:
               context.sell_all(stock)
       
       return context.get_positions()
   ```

5. **点击保存**
6. **期望结果**: 策略创建成功，跳转到策略列表

#### 5.3 查看策略详情

1. **在策略列表中点击刚创建的策略名称**
2. **进入策略详情页面**
3. **检查各项信息是否正确显示**
4. **切换不同标签页**: 基本信息、代码编辑、参数管理

#### 5.4 编辑策略信息

1. **在策略详情页面点击"编辑"按钮**
2. **修改策略描述为**: `修改后的双均线策略测试`
3. **修改持仓数量为**: `8`
4. **点击保存**
5. **期望结果**: 策略信息更新成功

#### 5.5 编辑策略代码

1. **在策略详情页面点击"代码编辑"标签**
2. **修改选股函数持仓数量为8**:

   ```python
   # 选择前8只股票
   selected = list(close_prices.keys())[:8]
   ```

3. **点击保存代码**
4. **期望结果**: 代码保存成功，显示保存提示

#### 5.6 策略参数管理

1. **切换到"参数管理"标签**
2. **点击"添加参数"按钮**
3. **选择之前创建的参数**: `test_user.test_close_5`
4. **点击确认添加**
5. **期望结果**: 参数关联成功，参数列表中显示新参数
6. **测试删除参数关联**: 点击参数旁边的删除按钮
7. **期望结果**: 参数关联删除成功

#### 5.7 删除策略

1. **返回策略列表页面**
2. **找到测试均线策略**
3. **点击删除按钮**
4. **在确认对话框点击确定**
5. **期望结果**: 策略删除成功，从列表中消失

---

## 数据验证检查点

### 注册和登录检查

- [ ] 注册成功后跳转到登录页面
- [ ] 登录成功后右上角显示用户名 `test_user`
- [ ] 左侧菜单显示完整
- [ ] localStorage中存在token和userInfo

### 指标管理检查

- [ ] 能正常显示指标列表（包含系统指标）
- [ ] 搜索和筛选功能正常工作
- [ ] 创建指标成功，列表实时更新
- [ ] 编辑指标功能正常
- [ ] 状态切换功能正常
- [ ] 删除功能正常，带确认对话框

### 参数管理检查

- [ ] 能正常显示参数列表（包含系统参数）
- [ ] 数据源自动完成功能正常
- [ ] 创建参数成功，列表实时更新
- [ ] 编辑参数功能正常
- [ ] 删除功能正常，带确认对话框

### 策略管理检查

- [ ] 能正常显示策略列表（包含系统策略）
- [ ] 创建策略成功，包含完整的表单验证
- [ ] 查看策略详情功能正常
- [ ] 编辑策略信息功能正常
- [ ] 代码编辑功能正常，支持语法高亮
- [ ] 参数关联功能正常
- [ ] 删除功能正常，带确认对话框

---

## 调试技巧

### 前端调试

1. **打开浏览器开发者工具 (F12)**
2. **查看Console面板**: 检查JavaScript错误
3. **查看Network面板**: 检查API请求和响应状态
4. **查看Application面板**: 检查localStorage中的token和用户信息

### API调试

1. **健康检查**: 访问 `http://localhost:5000/health` 检查后端服务状态
2. **查看后端日志**: 终端中的Flask输出日志
3. **检查响应格式**: 确保API返回正确的JSON格式

### 常见问题处理

- **Token过期**: 重新登录获取新token
- **请求失败**: 检查后端服务是否正常运行
- **数据不显示**: 检查API响应和前端数据处理逻辑
- **表单验证**: 确保所有必填字段已正确填写

---

## 测试完成

通过以上测试流程，可以全面验证系统的用户注册、登录、指标管理、参数管理和策略管理等核心功能是否正常工作。每个功能模块都包含了完整的CRUD操作测试，确保前端界面与后端API的正确集成。